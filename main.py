
import pandas as pd
from Scrapin2 import Headlines
from GvB import score_text
from main2 import Calc_Profit
import datetime
import numpy as np

df = pd.read_excel('/Users/toto211738/Downloads/S&P500.xlsx')
name = df['Company']
ticker = df['Ticker']

def find_investment():
    Scores = []
    iterator = 1

    for i in range(len(name)):
        headlines = Headlines(name[i])
        print(iterator)
        iterator += 1

        score = []

        for headline in headlines:
            score.append(score_text(headline.text))

        avg = sum(score) / len(score)
        Scores.append(avg)

    return Scores



Scores = [0.07328316831683168, 0.08637128712871288, 0.19423663366336624, 0.03976504854368932, 0.06623762376237624, 0.15842079207920795, 0.08264950495049507, 0.016575247524752482, 0.0558930693069307, 0.10397326732673266, 0.07745940594059406, 0.09482475247524753, 0.05721485148514852, 0.10764554455445546, 0.1686089108910891, 0.07906138613861388, 0.1457693069306931, 0.044154455445544555, 0.0860980198019802, 0.11333627450980388, 0.13204803921568628, 0.14812970297029704, 0.10816237623762377, 0.11766138613861382, 0.03978316831683169, 0.04850693069306932, 0.032868999999999995, 0.08410495049504951, 0.13109306930693068, 0.1658217821782178, 0.2092811881188118, 0.11430000000000001, 0.1199029126213592, 0.12660792079207922, 0.12290194174757281, 0.15436435643564356, 0.07421287128712872, 0.1905118811881187, 0.022667961165048538, 0.07035148514851479, 0.18308019801980194, 0.17544158415841588, 0.12135346534653467, 0.11071584158415843, 0.14631188118811878, 0.30494059405940577, 0.10279801980198024, 0.03846435643564356, 0.1291089108910891, 0.04793663366336633, 0.19189207920792073, 0.07689900990099012, 0.11075049504950496, 0.1394881188118812, 0.16360891089108912, 0.06706831683168317, 0.09606930693069306, 0.10326831683168317, 0.0007660194174757257, 0.16638217821782175, 0.19002574257425744, 0.12107623762376236, -0.016832673267326733, -0.02194851485148515, 0.07693300000000003, 0.152492, 0.13705148514851484, 0.15261980198019798, 0.11726336633663367, 0.15138118811881188, 0.04225922330097086, 0.13845445544554452, 0.05424901960784311, 0.15976732673267327, 0.17781980198019795, 0.18533168316831683, 0.11123465346534651, 0.2476297029702971, 0.10806336633663369, 0.1878207920792079, 0.10293861386138614, 0.1470306930693069, 0.13476633663366336, 0.15465500000000007, 0.09906930693069309, 0.16347326732673265, 0.23992254901960783, 0.08353168316831683, 0.04953366336633665, 0.09415247524752475, 0.1355089108910891, 0.11224100000000004, 0.09091386138613863, 0.09883267326732674, 0.13610594059405937, 0.043130693069306926, 0.10404059405940595, 0.03915247524752476, 0.07237920792079207, 0.18934752475247524, 0.16203465346534654, 0.14781683168316834, 0.027154901960784326, 0.11065643564356431, 0.15603465346534648, 0.3141465346534651, 0.14301287128712872, 0.08602254901960785, 0.1821069306930693, 0.11913069306930696, 0.1890722772277228, 0.05141717171717173, 0.16817623762376238, 0.18830693069306928, 0.05388910891089109, 0.1373128712871287, 0.15329603960396035, 0.11968415841584157, -0.133523, 0.08262871287128712, 0.15318019801980196, 0.18679504950495046, 0.08343861386138618, 0.05036831683168317, 0.16233366336633667, 0.1517821782178218, 0.14457200000000003, -0.0071766990291262135, 0.0028376237623762286, 0.11043762376237627, 0.12696138613861385, 0.13435346534653464, 0.15498811881188115, 0.24793465346534657, 0.2087653465346534, 0.1334336633663366, 0.07310891089108912, 0.06335643564356437, 0.23316732673267324, 0.10291782178217823, 0.09301485148514849, 0.21216039603960407, 0.11252079207920791, 0.19567425742574254, 0.032421782178217826, 0.2000217821782178, 0.07267722772277228, 0.1414049504950495, 0.09390495049504953, 0.03914851485148515, 0.3399099009900987, 0.11473960396039604, 0.047323762376237644, 0.014577227722772266, 0.2017732673267326, 0.1512306930693069, 0.17865148514851478, 0.18385400000000002, 0.17406633663366336, 0.11796039603960394, 0.24656336633663362, 0.16235643564356425, 0.08074653465346535, 0.17450495049504947, 0.3433138613861385, 0.11460099009900994, 0.10055841584158413, 0.21317128712871278, 0.1566504950495049, 0.1463603960396039, 0.13863465346534656, 0.14564653465346536, 0.16181485148514851, 0.05169702970297031, 0.033614851485148506, 0.1877168316831683, 0.24646138613861385, 0.10543564356435646, 0.18038712871287127, 0.10627920792079211, 0.14035148514851487, 0.0769940594059406, 0.15311485148514853, 0.15571683168316836, 0.11836831683168317, 0.11707524752475251, 0.1692069306930693, 0.1067990099009901, 0.06763465346534653, 0.11601782178217822, 0.15813366336633666, 0.09471287128712874, 0.19067920792079215, 0.1503871287128713, 0.1454227722772277, 0.17305940594059405, 0.18072178217821772, 0.06784059405940596, 0.13123564356435644, 0.08180000000000003, 0.34624752475247506, -0.013666336633663363, 0.08570594059405942, 0.12893168316831682, 0.09029702970297031, 0.12047128712871286, 0.09318800000000001, 0.17285148514851487, 0.12889702970297032, 0.10727029702970298, 0.0909792079207921, 0.1123811881188119, 0.22538811881188117, 0.09595148514851487, 0.11480693069306933, 0.12271287128712871, 0.14550990099009897, 0.2147930693069307, 0.08805247524752477, 0.13825742574257432, 0.15980297029702967, 0.44481386138613854, 0.11196336633663363, 0.059372277227722786, 0.15934752475247516, 0.1318455445544554, 0.1569059405940594, 0.1685346534653464, 0.18057128712871284, 0.13846633663366337, 0.10647623762376238, 0.1958207920792079, 0.1789435643564356, 0.0763792079207921, 0.15184851485148512, 0.054568316831683186, 0.1373930693069307, 0.09829, 0.09996633663366337, 0.15394653465346533, 0.2357217821782179, 0.24929306930693068, 0.14419306930693068, 0.026126732673267324, 0.08113861386138614, 0.1730287128712871, 0.2811881188118809, 0.12258910891089103, 0.11022871287128713, 0.08512871287128712, 0.04365247524752477, 0.2662821782178216, 0.1564178217821782, 0.05537821782178217, 0.10231980198019802, 0.12341287128712873, 0.0994131313131313, 0.07450000000000001, 0.1727059405940594, 0.18330000000000002, 0.022964000000000002, 0.16786039603960393, 0.17035841584158412, 0.07668217821782176, 0.21988415841584155, 0.023083168316831687, 0.15803861386138615, 0.18276930693069313, 0.10115841584158415, 0.11616237623762375, 0.18200891089108906, 0.106970297029703, 0.17814851485148514, 0.10540594059405935, 0.1721940594059406, 0.48619306930693074, 0.1135247524752475, 0.30301584158415823, 0.11842871287128715, 0.15494257425742566, 0.30786138613861386, 0.08908217821782179, 0.12219207920792079, 0.4441871287128717, 0.16937326732673263, 0.06175445544554458, 0.12012574257425739, 0.1361574257425743, 0.19388415841584156, 0.09639702970297029, 0.09754999999999998, 0.0548930693069307, 0.05404403669724772, 0.11785940594059405, 0.12878316831683168, 0.0706663366336634, 0.291817821782178, 0.10952871287128713, 0.06577623762376238, 0.14695841584158417, 0.0441851485148515, 0.14287326732673264, 0.19181980198019807, 0.2310544554455444, 0.14114950495049508, 0.067376, 0.12804653465346533, 0.0990108910891089, 0.10703465346534655, 0.12773366336633662, 0.11616732673267326, 0.1142346534653465, 0.246328712871287, 0.08976831683168317, 0.14560891089108907, 0.10651782178217822, 0.10129405940594058, 0.24182574257425746, 0.055568316831683166, 0.124470297029703, 0.09411386138613863, 0.10296336633663367, 0.09408910891089113, 0.26037029702970305, 0.20546732673267326, 0.14315841584158417, 0.0907782178217822, 0.19980099009900984, 0.1543613861386139, 0.06508019801980197, 0.19431287128712874, 0.09751287128712872, 0.06664851485148517, 0.15510000000000002, 0.2563524752475245, 0.13801782178217822, 0.12411287128712871, 0.21884851485148518, 0.0964930693069307, 0.1928980198019802, 0.05925544554455444, 0.10718613861386136, 0.35214059405940584, 0.13960495049504953, 0.1146207920792079, 0.3085851485148513, 0.16474257425742578, 0.06437326732673267, 0.15614059405940592, 0.1923455445544554, 0.057120792079207935, 0.19615445544554458, 0.07263267326732675, 0.16423366336633666, 0.16170495049504943, 0.10341386138613855, 0.18533267326732683, 0.367968316831683, 0.22780792079207918, 0.17242376237623763, 0.055419801980198025, 0.035135643564356445, 0.17336831683168305, 0.1664970297029703, 0.1388346534653465, 0.3618564356435647, 0.18830396039603955, 0.4246702970297027, 0.06736039603960399, 0.1896999999999999, 0.14837326732673264, 0.08076237623762378, 0.11102376237623762, 0.13638712871287131, 0.17094554455445543, 0.14091089108910887, 0.2430217821782178, 0.09331809523809521, 0.1701891089108911, 0.11843366336633658, 0.06607227722772277, 0.138286, 0.086782, 0.07016435643564356, 0.08520693069306932, 0.12977623762376234, 0.13595346534653463, 0.1559059405940594, 0.1340108910891089, 0.14862079207920795, 0.07526633663366336, 0.2152683168316831, 0.1653188118811881, 0.17570990099009906, 0.15834356435643562, 0.5778138613861381, 0.034464356435643564, 0.2344138613861387, 0.14764455445544544, 0.17271881188118818, 0.12146336633663363, 0.11190495049504949, 0.15033960396039606, 0.13775742574257427, 0.1367465346534653, 0.2702099009900989, 0.14335841584158415, 0.234309900990099, 0.15041584158415844, 0.1549861386138614, 0.10249504950495054, 0.05800792079207919, 0.046647524752475265, 0.07370594059405941, 0.1272910891089109, 0.09986435643564358, 0.14270594059405944, 0.1182059405940594, 0.1216069306930693, 0.1604574257425742, 0.06234059405940593, 0.2434970297029703, 0.4000782178217823, 0.09298316831683169, 0.05001188118811883, 0.13507425742574258, 0.12683267326732672, 0.08130990099009903, 0.214249504950495, 0.14505247524752474, 0.1528405940594059, 0.15561980198019798, 0.13720495049504952, 0.17360198019801973, -0.0037851485148514786, 0.12580396039603964, 0.12071485148514852, 0.150429702970297, 0.21981089108910884, 0.14334554455445545, 0.14496732673267324, 0.10344141414141417, 0.11094653465346534, 0.05985841584158417, 0.17324158415841584, 0.11551980198019798, 0.16010495049504947, 0.06625742574257427, 0.15487326732673268, 0.17320594059405936, 0.11492772277227724, 0.081489, 0.12403100000000002, 0.1536811881188119, 0.16340000000000002, 0.15017399999999997, -0.018536633663366348, 0.12836237623762373, 0.11886336633663364, 0.16858811881188124, 0.14638712871287127, 0.10935940594059408, 0.312819801980198, 0.10687425742574257, 0.05029714285714285, 0.07691980198019803, 0.19246435643564358, 0.11588415841584164, 0.14863168316831682, 0.16073267326732674, 0.1292316831683168, 0.1476762376237624, 0.31292277227722753, 0.1408108910891089, 0.029621782178217825, 0.13745544554455444, 0.13549702970297028, 0.09364455445544555, 0.06350400000000003, 0.07939702970297027, 0.13263564356435645, 0.1255811881188119, 0.14264950495049503, 0.11594851485148516, 0.13983960396039605, 0.22551386138613855, 0.27179702970297037, 0.07527425742574256, 0.1802584158415842, 0.02683614457831325, 0.0994, 0.07772376237623761, 0.17988217821782174, 0.19510990099009906, 0.16673267326732674, 0.09994851485148516, 0.11133500000000002, 0.02798217821782179, -0.02557227722772277, 0.012999999999999998, 0.32070099009901, 0.12317623762376238, 0.06264752475247526]

companies = dict(zip(name, Scores))
companies = dict(sorted(companies.items(), key=lambda item: item[1]))



def new_investment(Ticker_List, Investment_List):
    today = '2023-05-24'
    tommorow = "2023-05-25"

    profts = []
    iter = 1

    for i in range(len(Ticker_List)):
        print(iter)
        iter+=1
        investment = Investment_List[i]
        try:
            profit = Calc_Profit(Ticker_List[i],today,tommorow,investment)
            profts.append(profit)
            print(investment, profit)
        except:
            print('Erorr Here')
            profts.append(Investment_List[i])

    return profts

tens = np.ones(504) * 10


profits = new_investment(ticker,tens)
print(profits)













