
import pandas as pd
from Scrapin2 import Headlines
from GvB import score_text
from main2 import Calc_Profit
import datetime
import numpy as np

df = pd.read_csv("S&P500.csv")
name = df['Company']
ticker = df['Ticker']

def find_investment():
    Scores = []
    iterator = 1

    for i in range(len(name)):
        headlines = Headlines(name[i])
        print(iterator)
        iterator += 1

        score = []

        for headline in headlines:
            score.append(score_text(headline.text))

        avg = sum(score) / len(score)
        Scores.append(avg)

    return Scores


#scores = find_investment()
#print(scores)

Scores = [0.055554455445544534, 0.09205148514851484, 0.19639900990099002, 0.09187156862745098, 0.09841980198019802, 0.10843762376237626, 0.0786970297029703, 0.035881188118811885, 0.033709900990099004, 0.07306831683168317, 0.07170495049504952, 0.007065346534653472, 0.02782574257425743, 0.14605544554455444, 0.16856138613861385, 0.024620792079207927, 0.15575445544554456, 0.08002277227722772, 0.08890495049504951, 0.15426831683168313, 0.15944752475247523, 0.12361782178217821, 0.13429900990099006, 0.08984356435643563, 0.07533592233009709, 0.04431584158415842, -0.001199999999999995, 0.0736920792079208, 0.15477821782178217, 0.14022475247524757, 0.19634455445544555, 0.04626633663366337, 0.14470792079207923, 0.08471782178217821, 0.10945922330097083, 0.16087425742574257, 0.06593564356435644, 0.14286435643564355, 0.040757281553398056, 0.020582352941176486, 0.18015643564356434, 0.19176633663366335, 0.09093366336633667, 0.1647267326732673, 0.14345544554455444, 0.26652574257425726, 0.09602970297029703, 0.06031188118811882, 0.1272524752475247, 0.058989108910891104, 0.17041188118811876, 0.09349705882352943, 0.12004300000000002, 0.17530198019801974, 0.15604950495049502, 0.07191881188118814, 0.1295811881188119, 0.0810039603960396, 0.05216435643564357, 0.16772574257425743, 0.18421386138613863, 0.08873465346534655, -0.003103960396039602, 0.0555485436893204, 0.0776673267326733, 0.14908217821782177, 0.14826633663366334, 0.15628811881188118, 0.1520544554455446, 0.135829702970297, 0.0593891089108911, 0.10935247524752474, 0.08114653465346533, 0.14475940594059405, 0.14662673267326734, 0.15495940594059404, 0.13958217821782176, 0.15740297029702974, 0.12642574257425743, 0.158563, 0.12266274509803925, 0.16337920792079205, 0.13334158415841585, 0.121182, 0.058606930693069305, 0.14375247524752474, 0.2534862745098039, 0.05967623762376239, 0.062350495049504955, 0.1284910891089109, 0.09080990099009902, 0.03908999999999998, 0.09882772277227724, 0.1593900990099011, 0.18193069306930693, 0.033074257425742555, 0.10594554455445544, 0.06560198019801981, 0.038758415841584175, 0.1635455445544554, 0.15108514851485147, 0.1538019801980198, 0.034100000000000005, 0.08723069306930693, 0.15263069306930693, 0.31685346534653447, 0.145080198019802, 0.07120198019801982, 0.17319900990099013, 0.04340198019801982, 0.24288316831683165, 0.058753535353535356, 0.1617970297029703, 0.15283762376237625, 0.0670148514851485, 0.11621089108910891, 0.15469999999999995, 0.12759801980198018, -0.16147722772277232, 0.06934752475247526, 0.1469960396039604, 0.21621584158415835, 0.08682700000000003, 0.07783663366336635, 0.15648316831683173, 0.13518712871287128, 0.13302178217821778, -0.02865148514851486, 0.010209900990099007, 0.14538019801980193, 0.12629405940594055, 0.13173267326732668, 0.15740198019801976, 0.24870198019801984, 0.19037524752475246, 0.11241782178217818, 0.10703663366336635, 0.018718811881188114, 0.23086732673267313, 0.09186138613861389, 0.053783168316831685, 0.20351485148514847, 0.10450297029702972, 0.2112881188118812, 0.07748514851485148, 0.2599346534653465, 0.06332277227722771, 0.19802574257425734, 0.06821881188118813, 0.07237623762376239, 0.36111089108910877, 0.1017267326732673, 0.06437326732673271, 0.012426732673267323, 0.13410990099009898, 0.1452504950495049, 0.18219504950495044, 0.21334999999999998, 0.17386138613861385, 0.12093861386138614, 0.2120970297029703, 0.13619207920792073, 0.08198118811881187, 0.17603267326732672, 0.32937227722772267, 0.09189405940594059, 0.08114653465346534, 0.20269405940594054, 0.14951386138613856, 0.10165940594059403, 0.14177722772277226, 0.13781287128712874, 0.16077326732673264, 0.03290990099009903, 0.07627128712871287, 0.2011732673267326, 0.23421584158415837, 0.10547326732673272, 0.180819801980198, 0.13780396039603962, 0.11675940594059406, 0.1100158415841584, 0.17835742574257418, 0.15452475247524755, 0.13264554455445543, 0.10515247524752479, 0.13943366336633664, 0.11141980198019799, 0.11797722772277229, 0.14026732673267325, 0.14372475247524755, 0.091790099009901, 0.2311356435643565, 0.17379801980198023, 0.12388514851485147, 0.19099801980198017, 0.14998118811881186, 0.10479603960396042, 0.12991683168316828, 0.09442079207920796, 0.3380069306930691, -0.008690099009900976, 0.0688980198019802, 0.11004356435643563, 0.11180891089108914, 0.15022178217821783, 0.104293, 0.20348118811881188, 0.11342871287128711, 0.10302574257425744, 0.10173564356435644, 0.08635148514851487, 0.1393990099009901, 0.07282574257425743, 0.09949207920792077, 0.14176138613861386, 0.14856138613861383, 0.19901485148514855, 0.041660396039603954, 0.06681485148514851, 0.17618019801980198, 0.41655049504950487, 0.1588732673267327, 0.05590693069306932, 0.2129475247524754, 0.08925784313725492, 0.14250297029702974, 0.1609425742574256, 0.1540376237623762, 0.1502881188118812, 0.0935158415841584, 0.25713069306930697, 0.17193168316831678, 0.0925752475247525, 0.10554257425742576, 0.06578019801980198, 0.13776633663366336, 0.09685700000000003, 0.11874950495049505, 0.1506079207920792, 0.18430000000000005, 0.19258316831683164, 0.13483366336633662, 0.025027722772277237, 0.07620594059405941, 0.14577326732673268, 0.3027376237623761, 0.0768, 0.1721891089108911, 0.06968019801980198, 0.04693762376237625, 0.28034158415841565, 0.1302475247524752, 0.05393366336633662, 0.051858415841584175, 0.09684158415841584, 0.07422828282828282, 0.10866534653465346, 0.15811099999999997, 0.14377425742574254, 0.019158415841584158, 0.15503168316831686, 0.15867425742574254, 0.0485, 0.23107821782178217, 0.039429702970297034, 0.16003762376237618, 0.16603861386138613, 0.12046039603960393, 0.14057623762376237, 0.17455841584158407, 0.08735300000000003, 0.18456633663366342, 0.09482574257425744, 0.1683732673267327, 0.571573267326733, 0.11079999999999995, 0.30899504950495027, 0.0910970297029703, 0.15993564356435633, 0.23338514851485137, 0.10757722772277227, 0.11921485148514853, 0.4478277227722774, 0.1531841584158416, 0.05198712871287129, 0.1270009900990099, 0.10586138613861386, 0.2003792079207921, 0.09430792079207921, 0.05061818181818181, 0.0648060606060606, -0.00362761904761905, 0.1106386138613861, 0.11336039603960393, 0.1041584158415842, 0.29143762376237614, 0.08401782178217823, 0.04060396039603961, 0.13722475247524757, 0.04765742574257427, 0.11990792079207922, 0.20857029702970298, 0.24137524752475242, 0.1580009900990099, 0.060377227722772285, 0.07606831683168319, 0.12309999999999997, 0.1356168316831683, 0.13569603960396034, 0.10877920792079208, 0.13513366336633664, 0.2690118811881187, 0.10497623762376239, 0.13055148514851478, 0.11111386138613862, 0.1423465346534653, 0.17370000000000002, 0.05562871287128713, 0.13958910891089105, 0.09002673267326733, 0.0878712871287129, 0.07764851485148513, 0.2522891089108911, 0.21319108910891088, 0.11659603960396042, 0.12041881188118811, 0.14690297029702962, 0.13807600000000003, 0.07267722772277227, 0.19368613861386136, 0.06453960396039604, 0.07800396039603961, 0.13356534653465346, 0.2472316831683167, 0.14614158415841585, 0.13398712871287125, 0.21031683168316834, 0.13800396039603963, 0.1778811881188119, 0.06055049504950494, 0.1480683168316832, 0.27546435643564365, 0.08347326732673267, 0.10354752475247524, 0.2952326732673266, 0.15559702970297032, 0.09266930693069306, 0.14483564356435638, 0.22369702970297023, 0.10369108910891085, 0.1683009900990099, 0.0947811881188119, 0.15298217821782178, 0.15875049504950495, 0.11382475247524748, 0.15434752475247526, 0.4124099009900988, 0.22317623762376237, 0.16310198019801977, 0.08790693069306929, 0.07606831683168316, 0.17000099009900982, 0.15298910891089107, 0.149419801980198, 0.3444138613861388, 0.17067821782178214, 0.3970039603960393, 0.08027128712871288, 0.20773168316831678, 0.1531386138613861, 0.06368514851485149, 0.12378019801980197, 0.13444752475247523, 0.1775950495049505, 0.1549435643564356, 0.22420990099009905, 0.07893238095238096, 0.16897029702970295, 0.1408287128712871, 0.08135742574257425, 0.155303, 0.0733, 0.054903960396039606, 0.10410891089108913, 0.14305544554455443, 0.11312970297029705, 0.16016039603960397, 0.13032079207920794, 0.07341188118811882, 0.09239207920792078, 0.1845643564356435, 0.13801299999999997, 0.15800297029702973, 0.1605861386138614, 0.48954752475247476, 0.04045049504950494, 0.25078712871287145, 0.14320495049504942, 0.17141188118811873, 0.14322772277227722, 0.10480297029702973, 0.17996633663366335, 0.14050792079207922, 0.15764554455445542, 0.2777148514851483, 0.11655643564356435, 0.2660742574257425, 0.15673366336633662, 0.15695742574257426, 0.11359801980198021, 0.0688039603960396, 0.04204752475247525, 0.07383762376237624, 0.13721881188118815, 0.0962920792079208, 0.15781089108910892, 0.09683762376237626, 0.13568316831683172, 0.1884336633663366, 0.05769702970297031, 0.25980693069306937, 0.36154653465346537, 0.10534158415841585, 0.048418811881188115, 0.12255049504950492, 0.12915940594059405, 0.09810099009900992, 0.2143287128712871, 0.1276663366336634, 0.14847326732673266, 0.14915544554455443, 0.17650198019801971, 0.17231188118811883, -0.018965346534653458, 0.11426732673267329, 0.11387524752475249, 0.15258019801980194, 0.22670297029702968, 0.12872376237623764, 0.14998217821782173, 0.11754795918367346, 0.10205445544554453, 0.07965643564356437, 0.1582009900990099, 0.10869603960396039, 0.16769504950495043, 0.07942079207920792, 0.16569801980198018, 0.17345544554455444, 0.07257326732673268, 0.05254356435643566, 0.131478, 0.19036732673267331, 0.18328217821782175, 0.16892699999999994, -0.011791089108910906, 0.12038712871287127, 0.1655316831683168, 0.19130891089108912, 0.1660455445544554, 0.09902970297029702, 0.31021881188118827, 0.11258514851485146, 0.04148737864077667, 0.11108811881188123, 0.1615168316831683, 0.110850495049505, 0.1444346534653465, 0.13368019801980202, 0.13872079207920793, 0.13838712871287126, 0.26872574257425735, 0.14778217821782177, 0.04774851485148516, 0.1435386138613861, 0.10888613861386139, 0.09947524752475248, 0.05023663366336634, 0.0821881188118812, 0.13290990099009903, 0.11575742574257425, 0.2020950495049504, 0.11478514851485144, 0.12236138613861387, 0.22987326732673263, 0.2739891089108911, 0.05683398058252428, 0.10569702970297033, 0.04538170731707317, 0.07976930693069308, 0.0779059405940594, 0.18954851485148513, 0.1514108910891089, 0.1546019801980198, 0.10206534653465345, 0.10240990099009901, 0.01613267326732673, -0.03674455445544554, 0.049908910891089106, 0.2836693069306931, 0.08732871287128716, 0.044844554455445544]

companies = dict(zip(name, Scores))
companies = dict(sorted(companies.items(), key=lambda item: item[1]))



def new_investment(Ticker_List, Investment_List):
   
    today = datetime.date.today()
    tommorow = today + datetime.timedelta(days=1)

    profts = []
    iter = 1

    for i in range(len(Ticker_List)):
        print(iter)
        iter+=1
        investment = Investment_List[i]
        try:
            profit = Calc_Profit(Ticker_List[i],today,tommorow,investment)
            profts.append(profit)
            print(investment, profit)
        except:
            print('Erorr Here')
            profts.append(Investment_List[i])

    return profts

tens = np.ones(504) * 10


profits = new_investment(ticker,Scores)
print(np.sum(profits))

#print(companies)











